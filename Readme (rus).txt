rep_it - программа для записи и воспроизведения клавиатурных макросов с помощью горячих клавиш

Предварительные условия: должны быть установлены Python 2.6 и PyWin32, затем нужно скопировать папку pyHook и файл pyHook.pth в <PythonDir>\Lib\site-packages.

Макросы находятся в файле macros.txt и вводятся двумя способами: либо редактированием этого файла вручную, либо с использованием горячих клавиш:
1. Нажимаете ctrl+alt+F1
2. Нажимаете горячие клавиши для вызова макроса, например alt+h
3. Нажимаете ctrl+alt+F1
4. Нажимаете клавиши "тела" макроса, например "Hello, world!"
5. Нажимаете ctrl+alt+F3.
В результате в macros.txt добавится определение макроса следующего вида:

<Name>
<Shortcut>alt+h
<Events>" H e l l o , space w o r l d ! "

Тэги <Name>, <Shortcut> и <Events> обязательны во всех макросах. При редактировании macros.txt вручную все клавиши, кроме букв, пишутся в нижнем регистре.

Более сложный пример макросов:
<Name>double quotes
<Shortcut>alt+2
<Events>sl en " " left rl

<Name>
<Comment>Called by sequece of two keys, executes 10 times
<Count>10
<Shortcut>a b
<Events>s1 double_quotes sleep 0.2 <r+>Abc<r-> D e f

<r+> - "сырой" режим ввода, когда можно вводить только отображаемые клавиши.
<r-> - "обычный" режим (по умолчанию), когда можно вводить все клавиши, но с пробелами между ними.

Названия некоторых клавиш:
клавиша контекстного меню - apps
backspace - back
caps lock - caps
escape - esc
insert - ins
num lock - num
цифры на цифровой клавиатуре - numpad0 .. numpad9
page down - pgdn
page up - pgup
pause/break - pause
print screen - prtsc
scroll lock - scroll
space bar - space
win key - win
арифм. операции на цифровой клавиатуре - add, sub, mul, div
точка на цифровой клавиатуре - decimal

Задержка: sleep <N1> или s<N2>, где <N1> - кол-во секунд, <N2> - кол-во десятичных долей секунды

en - переключение на латинскую раскладку
ru - переключение на русскую раскладку
sl (save language) - запоминание текущего языка
rl (restore language) - восстановление языка, запомненного последней командой sl
Эти команды используют alt+shift для переключения раскладки

Предопределенные горячие клавиши:
ctrl+alt+F1 уже рассмотрели.
ctrl+alt+F2 - то же, что и ctrl+alt+F1, только горячие клавиши для вызова макроса отображаются при вводе.
ctrl+alt+F4 - отключение всех горячих клавиш (режим ожидания).
ctrl+alt+F3 - в режиме записи макроса заканчивает запись, в режиме ожидания выходит из него (включает горячие клавиши), в обычном режиме читает заново macros.txt.
ctrl+alt+e - открытие macros.txt на редактирование.

В теле макроса можно использовать название другого макроса, в котором пробелы заменены на знаки подчеркивания. Осторожнее с рекурсией!
Макрос можно вызвать как по сочетанию клавиш (alt+t), так и по их последовательности (ctrl+x 7 alt+b).
При записи макроса можно использовать следующие последовательности клавиш:
pause <цифра> . <цифра> или pause . <цифра>
В результате в тело макроса будет добавлена задержка (в секундах): sleep <цифра>.<цифра>
